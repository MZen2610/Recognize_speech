# Распознаём речь
Данная программа позволяет автоматизировать обращения клиентов в чате Telegram и VK
с помощью Dialogflow от Google. 

#### Что такое Dialogflow?

Это облачный сервис распознавания естественного языка от Google, который поддерживает 
различные языки, в том числе русский.

#### Обсуждаемые темы с ботом
- Приветствие
  - Привет
  - Helloy ... и т.д.
- Вопросы от действующих партнёров
  - Где проходит совещание
  - Когда переведёте деньги по контракту
  - Задерживаемся на совещание
  - Высылаю итоги совещания
  - Когда подписываем контракт?
  - Контракт уже в силе? ... и т.д.
- Вопросы от забаненных
  - За что меня забанили
  - Мой друг ничего не сделал, а его забанили ... и т.д.
- Забыл пароль
  - Как востановить пароль
  - Не могу войти в аккаунт ... и т.д.
- Как устроиться к вам на работу
- Удаление аккаунта
- Устройство на работу
  - Как устроиться к вам на работу?
  - Хочу работать редактором у вас ... и т.д.

#### Пример работы Telegram
Для самостоятельного тестирования можно обратиться к боту telegram
````
@mzen_assistant_bot"
````

![TG](https://dvmn.org/filer/canonical/1569214094/323/)

#### Пример работы VK
![VK](https://dvmn.org/filer/canonical/1569214089/322/)

### Как установить

Для запуска скрипта вам понадобится установленный Python не ниже третьей версии.

Установите программу из репозитория:
```
git clone https://github.com/MZen2610/Recognize_speech.git
```

Затем установите зависимости
```
pip install -r requirements.txt
```

### Переменные окружения

Часть настроек проекта берётся из переменных окружения. Чтобы их определить, 
создайте файл `.env` рядом с `main.py` и запишите туда данные в таком формате: 
`ПЕРЕМЕННАЯ=значение`.

Доступные переменные:
- `TGM_TOKEN` - токен полученный при регистрации бота в телеграмм, выдает [@BotFather](https://telegram.me/BotFather).
- `VK_TOKEN` - Токен группы VK бота для диалога. Создайте группу в 
[Управление группами](https://vk.com/groups?tab=admin); Создайте токен в разделе `Работа с API` 
- `SESSION_ID` - id вашего чата. Чтобы получить свой chat_id, напишите в Telegram специальному боту: @userinfobot
- `PROJECT_ID` - Идентификатор проекта в Google Cloud Console
- `GOOGLE_APPLICATION_CREDENTIALS` - Путь к файлу с ключами DialogFlow

### Куда смотреть
- [Как создать проект в DialogFlow](https://cloud.google.com/dialogflow/docs/quick/setup).
- [Создать агента DialogFlow](https://cloud.google.com/dialogflow/docs/quick/build-agent).
- [Создание JSON-ключа](https://cloud.google.com/docs/authentication/getting-started).

# Тренировка DialogFlow
Для обучения бота создайте файл `questions.json` с содержанием навыков, пример:
```json
 {
    "Вопросы от забаненных": {
        "questions": [
            "Меня забанили",
            "Я в бане",
            "Разбаньте",
            "Разбаньте моего друга",
            "Разбаньте меня",
            "Почему я забанен",
            "За что меня забанили",
            "Можно-ли купить разбан?",
            "Хочу купить разбан",
            "Мой друг ничего не сделал, а его забанили"
        ],
        "answer": "Если вы забанены, вы нарушили правила нашего сообщества. При входе на сайт вы можете увидеть доказательства ваших нарушений и ссылку на нарушенное правило. Разбан не продаётся. Если вы ознакомились с правилами и доказательствами вашей вины и у вас всё ещё есть претензии — воспользуйтесь формой «Не виновен» под сообщением о бане."
    },
    "Вопросы от действующих партнёров": {
        "questions": [
            "Где проходит совещание",
            "Когда переведёте деньги по контракту",
            "Скоро переведу деньги по контракту",
            "Задерживаемся на совещание",
            "Высылаю итоги совещания",
            "Когда подписываем контракт?",
            "Контракт уже в силе?"
        ],
        "answer": "Простите, в этом чате сидит SMM-отдел, мы не знаем ответа на этот вопрос. Обратитесь напрямую к сотруднику, с которым работаете."
    }
}
```

Обучите DialogFlow командой:
```
python create_intent.py
```

## Запуск

Для запуска Telegram бота используйте команду:
```
python3 tg_bot.py
```
Для запуска VK бота используйте команду:
```
python vk_bot.py
```

## Цели проекта

Код написан в учебных целях — это задание по работе с обучением бота в телеграмм и VK, для автоматизации обращения клиентов в чате 
[Devman](https://dvmn.org).
